{% extends "base.html" %}
{% load static %}
{% block content %}

<style>
    body{
        background: linear-gradient(to right, #00c6ff, #0072ff, #8e2de2, #4a00e0);
    }
    .cart-container {
        display: flex;
        justify-content: flex-start;
        flex-wrap: wrap;
    }

    .cart-left {
        flex: 0 0 auto;
        width: 60%;
        margin-left: 50px;
    }

    .cart-right {
        position: fixed;              
        margin-top: 50px;                      
        right: 50px;                        
        width: 28%;
        height: 55%;
        margin: 20px;                    
        border: 1px solid #000;
        border-radius: 10px;
        text-align: center;
        z-index: 1000;   
        background-color: white;
        border-radius: 15px;
        border: 3px solid black;
    }


    .box {
        border: 3px solid #000;
        border-radius: 10px;
        background-color: white;
        margin: 20px 0;
        padding: 15px;
        max-width: 100%;
        width: 100%;
        margin-left: 0;
    }

    .buynow{
        background: linear-gradient(#A40606 ,#D98324);
        color: white;
    }
    .remove{
        background: linear-gradient(#B91372 ,#6B0F1A);
        color: white;
        width: 100px;
    }
    .price-details{
        padding: 1.5cm;
    }
    @media(max-width: 1440px){
        .cart-right{
            height: 72%;
        }
        .price-details{
           padding: 0.5cm;
        }
    }
    @media(max-width: 1024px){
        .cart-left {
            width: 65%;
            margin-left: 16px;
            margin-right: 2%;
        }

        .cart-right {
            width: 27%;
            right: 2px;
        }
    }
    @media (max-width: 768px) {
        .cart-container {
            flex-direction: column;
        }

        .cart-left,
        .cart-right {
            margin-left: auto;
            width: 100%;
        }

        .cart-right {
            position: static;
            margin-right: auto;
        }
    }

</style>

<h1 style="text-align: center; color: rgb(248, 237, 237);"><b> <strong>MY CART PAGE</strong> </b></h1>
<div class="cart-container">
    
    <div class="cart-left">
        
        {% for item in cart_items %}
        <div class="box">
        <div class="container-fluid">
        <div class="row align-items-center">
            
            <div class="col-12 col-md-3 text-center mb-3 mb-md-0">
                <img src="{{ item.products.image.url }}" alt="no_img" height="100" width="80">
            </div>

            
            <div class="col-12 col-md-6 text-start product-details">
                <h5>{{ item.products.product_name|title }}</h5>
                <p>Seller: {{ item.products.seller.username }}</p>
                <p>Colour: {{ item.products.colour }}</p>
                <div class="d-flex flex-wrap align-items-center gap-2">
                    <span class="text-decoration-line-through text-muted">₹{{ item.total_price }}</span>
                    <span class="fw-bold">₹{{ item.discount_price }}</span>
                    <span class="text-success">{{ item.products.discount }}% Off</span>
                    <span class="me-2">₹{{ item.products.delivery_charge }} for Delivery Charge</span>
                </div>
                <p class="fw-bold mt-2">Total: ₹{{ item.total_amount }}</p>
            </div>

           
            <div class="col-12 col-md-3 text-center">
                <div class="btn-group mb-3" role="group">
                    <form method="POST" action="{% url 'cart_quantity' item.id 'decrease' %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-outline-secondary btn-sm rounded-circle">−</button>
                    </form>
                    <span class="px-3">{{ item.quantity }}</span>
                    <form method="POST" action="{% url 'cart_quantity' item.id 'increase' %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-outline-secondary btn-sm rounded-circle">+</button>
                    </form>
                </div>

                <div class="d-flex justify-content-center">
                    <a href="{% url 'remove_products' item.id %}" class="btn remove btn-sm" 
                        onclick="return confirm('Are you sure you want to remove this item?')"> Remove </a>
                    <!-- <a href="#" class="btn buynow btn-sm">Buy Now</a> -->

                </div>
            </div>
        </div>
        </div>  
        </div>
{% endfor %}
    </div>

    
        <div class="cart-right">
        <div class="price-details rounded shadow-sm">
            <h5 class="fw-bold text-center">PRICE DETAILS</h5> 
            <hr>
            <div class="d-flex justify-content-between">
                <span>Price ({{ cart_items|length }} items)</span>
                <span>₹{{ total_price }}</span>
            </div><br>
            <div class="d-flex justify-content-between">
                <span>Discount</span>
                <span class="text-success">− {{ discount_price }}</span>
            </div><br>
            <div class="d-flex justify-content-between">
                <span>Platform Fee</span>
                <span>₹{{ cart_items|length }}</span>
            </div><br>
            <div class="d-flex justify-content-between">
                <span>Delivery Charges</span>
                <span>₹{{ delivery_charge }}</span>
            </div><br>
            <hr>
            <div class="d-flex justify-content-between fw-bold">
                <span>Total Amount</span>
                <span>₹{{ total_amount_cart }}</span>
            </div>
            <p class="mt-3 text-center text-success"><b>You will save ₹{{ discount_price}} on this order</b></p>

            <div class="text-center mt-3">
                
                <form method="GET" action="{% url 'cart_place_order' %}">
                    {% csrf_token %}
                    <button class="btn btn-place-order px-4 py-2 text-white" style="background: linear-gradient(#B91372,#6B0F1A);">
                        PLACE ORDER
                    </button>
                </form>

            </div>
        </div>
    </div>
</div>

{% endblock %}
